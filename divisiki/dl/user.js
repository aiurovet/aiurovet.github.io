////////////////////////////////////////////////////////////////////////////////
// Copyright (C) Alexander Iurovetski 2024
// All rights reserved under MIT license (see LICENSE file)
//
// Manage application data and preferences
////////////////////////////////////////////////////////////////////////////////

"use strict";

import {GamesClass} from "./games.js";

////////////////////////////////////////////////////////////////////////////////

class UserClass {
  // Constants
  //
  static defaultId = "Anonymous";

  //////////////////////////////////////////////////////////////////////////////

  // User id (free text)
  //
  id = this.defaultId;

  // List of game stats
  //
  #games = [new GameClass()];

  //////////////////////////////////////////////////////////////////////////////

  constructor(id, games) {
    if ((id !== undefined) && (id !== null)) {
      this.id = id ?? defaultId;
    }
    if ((games !== undefined) && (games !== null) && Array.isArray(games)) {
      if ((games.length > 0) && (games[0] instanceof GameClass)) {
        this.#games = games;
      }
    }
  }

  //////////////////////////////////////////////////////////////////////////////

  acceptActiveGame() {
    this.#games.acceptActive();
  }

  //////////////////////////////////////////////////////////////////////////////

  fromSerializable(that) {
    this.id = that.id;
    this.#games = GamesClass.fromSerializable(that.games);
  }

  //////////////////////////////////////////////////////////////////////////////

  setActiveGameNo(value) {
    this.#games.setActiveNo(value);
  }

  //////////////////////////////////////////////////////////////////////////////

  toSerializable() {
    return {
      id: this.id,
      games: this.#games.toSerializable()
    };
  }

  //////////////////////////////////////////////////////////////////////////////
}