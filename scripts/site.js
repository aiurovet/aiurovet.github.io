////////////////////////////////////////////////////////////////////////////////
// Copyright (C) Alexander Iurovetski 2023
// All rights reserved under MIT license (see LICENSE file)
////////////////////////////////////////////////////////////////////////////////

const NakedRootUrls = [ 'aiurovet.com', 'aiurovet.github.io' ];

////////////////////////////////////////////////////////////////////////////////
// Current page's entry point
////////////////////////////////////////////////////////////////////////////////

$(document).ready(function () {
  initHeader();
});

////////////////////////////////////////////////////////////////////////////////
// Returns top-level URL in both local and remote mode
////////////////////////////////////////////////////////////////////////////////

function getRootUrl(withHtml) {
  var url = window.location.href;

  // Loop though the top-level naked URLs to find the right one
  // If not found, return the current URL

  for (var i = 0, n = NakedRootUrls.length; ; i++) {
    if (i >= n) {
      return url;
    }

    var nakedRootUrl = NakedRootUrls[i];
    var startPos = url.indexOf(nakedRootUrl);

    if (startPos >= 0) {
      break;
    }
  }

  // Cut off anything beyond the top-level naked URL found
  // and append the index filename if required, then return
  // the result

  url = url.substring(0, startPos + nakedRootUrl.length);

  if (withHtml) {
    url += '/index.html';
  }

  return url;
}

////////////////////////////////////////////////////////////////////////////////
// Initialize header: set click handler
////////////////////////////////////////////////////////////////////////////////

function initHeader() {
  const jqHeader = $('.header');

  if (!jqHeader.hasClass('home')) {
    jqHeader.click(onHeaderClick);
  }
}

////////////////////////////////////////////////////////////////////////////////
// Header click handler - redirects to the home page
////////////////////////////////////////////////////////////////////////////////

function onHeaderClick() {
  window.location = getRootUrl(true);
}

////////////////////////////////////////////////////////////////////////////////