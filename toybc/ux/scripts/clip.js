////////////////////////////////////////////////////////////////////////////////
// Copyright (C) Alexander Iurovetski 2024
// All rights reserved under MIT license (see LICENSE file)
//
// Clipboard management
////////////////////////////////////////////////////////////////////////////////

'use strict';

////////////////////////////////////////////////////////////////////////////////

class ClipClass {
  constructor() {
    // Initialize properties
    //
    var c = navigator.clipboard;
    this.isAvailable = c && c.readText && c.writeText ? true : false;
  }

  //////////////////////////////////////////////////////////////////////////////
  // Read text from clipboard
  //////////////////////////////////////////////////////////////////////////////

  async read() {
    try {
      if (this.isAvailable) {
        Core.setFocusToEditor();
        return await navigator.clipboard.readText();
      }
    } catch (e) {
      Core.onError(e);
    }
  }

  //////////////////////////////////////////////////////////////////////////////
  // Write text to clipboard
  //////////////////////////////////////////////////////////////////////////////

  async write(text) {
    try {
      if (this.isAvailable) {
        Core.setFocusToEditor();
        await navigator.clipboard.writeText(text);
      }
    } catch(e) {
      Core.onError(e);
    }
  }

  //////////////////////////////////////////////////////////////////////////////
}